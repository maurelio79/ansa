<!DOCTYPE html> 

<html lang="it-IT">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="DESCRIPTION" content="">
    <title>Ansa Grabber</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    
    <link rel="stylesheet" href="jquery.mobile-1.3.2.min.css" />
    <link rel="stylesheet" href="ansa.min.css" />
    <link rel="stylesheet" href="style.css" />
    <script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
    <script src="js/jquery.mobile-1.3.2.min.js"></script>
	<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    
    
    <script type='text/javascript'>  
        // Parses returned response and extracts  
        // the title, links, and text of each news story.  
        function top_home(o){  
        var items = o.query.results.item;  
        var output = '';  
        var no_items=items.length;  
            for(var i=0;i<no_items;i++){  
            var title = items[i].title;  
            var link = items[i].link;  
            var desc = items[i].description;
            var pubDate = items[i].pubDate;  
            output += "<div class='news_content'><h3><a href='" + link + "'>"+ title +"</a></h3><span>" + pubDate + "</span><p>" + desc + "</p></div>";  
            }  
        // Place news stories in div tag  
        //document.getElementById('results').innerHTML = output;    
        $("#risultato").append(output);
    }  
    </script> 
    
    <script>
    $( "#indexpage").on('pageinit',function(event){
    
    });
    </script>

	<script>
		document.addEventListener("deviceready", onDeviceReady, false);

		function populateDB(tx) {
        tx.executeSql('DROP TABLE IF EXISTS PREFERNCE');
        tx.executeSql('CREATE TABLE IF NOT EXISTS PREFERENCE (id unique, category, link, status)');
        tx.executeSql('INSERT INTO PREFERENCE (id, category, link, status) VALUES (1, "Top News", "home.html", "active")');
        tx.executeSql('INSERT INTO PREFERENCE (id, category, link, status) VALUES (2, "Cronoca", "cronaca.html", "active")');
        tx.executeSql('INSERT INTO PREFERENCE (id, category, link, status) VALUES (3, "Economia", "economia.html", "inactive")');
        tx.executeSql('INSERT INTO PREFERENCE (id, category, link, status) VALUES (4, "Politica", "politica.html", "inactive")');
        tx.executeSql('INSERT INTO PREFERENCE (id, category, link, status) VALUES (5, "Scienza", "scienza.html", "active")');
        tx.executeSql('INSERT INTO PREFERENCE (id, category, link, status) VALUES (6, "Tecnologia", "tech.html", "active")');
        tx.executeSql('INSERT INTO PREFERENCE (id, category, link, status) VALUES (7, "Cinema", "cinema.html", "inactive")');
        tx.executeSql('INSERT INTO PREFERENCE (id, category, link, status) VALUES (8, "Mondo", "mondo.html", "active")');
    }

    function errorCB(err) {
        alert("Error processing SQL: "+err.code);
    }

	</script>
    
    </head>  
<body>
    <div data-role="page" data-theme="f" id="indexpage">
        <div data-role="header" data-position="fixed"  data-theme="f">
		<a href="index.html" data-type="button" data-icon="home"  data-inline="true" data-iconpos="notext" data-theme="a"  data-corners="false" class="ui-btn-left" data-ajax="false"></a>
        <h1>Ansa Grabber</h1>
		<a href="preferenze.html" data-type="button" data-icon="gear"  data-inline="true" data-iconpos="notext" data-theme="a"  data-corners="false" class="ui-btn-right" data-ajax="false"></a>

        </div>
        <!-- Div tag for stories results -->  
        <div  data-role="content" id="risultato"   data-theme="f">
		    <ul data-role="listview" data-theme="f">

		<script>
			function queryDB(tx) {
				tx.executeSql('SELECT category, link, status FROM PREFERENCE WHERE status="active"', [], querySuccess, errorCB);
			}

		function querySuccess(tx, results) {
		    var len = results.rows.length;
//		    console.log("DEMO table: " + len + " rows found.");
		    for (var i=0; i<len; i++){
//				alert("Row = " + i + " ID = " + results.rows.item(i).id + " Data =  " + results.rows.item(i).data);
				var link = results.rows.item(i).link;
				var category = results.rows.item(i).category;
				var status = results.rows.item(i).status;

				document.write("<li><a href='" + link + "' data-ajax='false'><img src='images/icon.jpg' width='80' height='80'><h3>'" + title + "'</h3> ");
		    }
		}

			function successCB() {
				var db = window.openDatabase("Ansa", "1.0", "Ansa Grabber", 200000);
				db.transaction(queryDB, errorCB);
			}
		</script>

		<script>
			function onDeviceReady() {
				var db = window.openDatabase("Ansa", "1.0", "Ansa Grabber", 200000);
				if (window.localStorage.getItem("preference") == null) {
					db.transaction(populateDB, errorCB, successCB);
				} else {
					db.transaction(queryDB, errorCB, successCB);
				}
			}
		</script>


        <!-- The YQL statment will be assigned to src. -->
		    <!--<ul data-role="listview" data-theme="f">
		    <li><a href="home.html" data-ajax="false"><img src="images/icon.jpg" width="80" height="80" /><h3>Top News</h3></a></li>
		    <li><a href="cronaca.html" data-ajax="false"><img src="images/icon.jpg" width="80" height="80" /><h3>Cronaca</h3></a></li>
		    <li><a href="economia.html" data-ajax="false"><img src="images/icon.jpg" width="80" height="80" /><h3>Economia</h3></a></li>
		    <li><a href="politica.html" data-ajax="false"><img src="images/icon.jpg" width="80" height="80" /><h3>Politica</h3></a></li>
			<li><a href="scienza.html" data-ajax="false"><img src="images/icon.jpg" width="80" height="80" /><h3>Scienza</h3></a></li>
		    <li><a href="tech.html" data-ajax="false"><img src="images/icon.jpg" width="80" height="80" /><h3>Tecnologia</h3></a></li>
		    <li><a href="cinema.html" data-ajax="false"><img src="images/icon.jpg" width="80" height="80" /><h3>Cinema</h3></a></li>
		    <li><a href="mondo.html" data-ajax="false"><img src="images/icon.jpg" width="80" height="80" /><h3>Mondo</h3></a></li>-->
		    </ul>
        </div>
        <div data-role="footer" data-position="fixed"  data-theme="f">
        </div>
    </div>
</body>
</html>  
